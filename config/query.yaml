query:
  querysets:
    # Combined queryset - returns data from multiple databases (JDBC + MongoDB)
    - name: all
      queries:
        - name: fruits
          connection: fruitdb
          queryString: SELECT name, color, taste FROM fruits
        - name: animals
          connection: animaldb
          queryString: SELECT name, species, age, habitat, diet FROM animals
        - name: books
          connection: bookdb
          mongoQuery:
            collection: books

    # Cassandra queryset
    - name: metrics
      queries:
        - name: cpu-metrics
          connection: cassandradb
          queryString: SELECT hostname, cpu_usage, recorded_at FROM metrics.cpu LIMIT 25

    # Individual querysets
    - name: fruits
      queries:
        - name: fruits
          connection: fruitdb
          queryString: SELECT name, color, taste FROM fruits

    - name: animals
      queries:
        - name: animals
          connection: animaldb
          queryString: SELECT name, species, age, habitat, diet FROM animals

    # MongoDB querysets
    - name: books
      queries:
        - name: books
          connection: bookdb
          mongoQuery:
            collection: books

    # Filtered MongoDB queries
    - name: books-fiction
      queries:
        - name: books
          connection: bookdb
          mongoQuery:
            collection: books
            filter: '{"genre":"Fiction"}'

    - name: books-selected-fields
      queries:
        - name: books-title-author
          connection: bookdb
          mongoQuery:
            collection: books
            fields: '{"title": 1, "author": 1, "_id": 0}'
        - name: books-fiction-selected
          connection: bookdb
          mongoQuery:
            collection: books
            filter: '{"genre":"Fiction"}'
            fields: '{"title": 1, "author": 1, "published": 1, "year": 1}'

    # Sort by title ascending
    - name: books-sorted-by-title
      queries:
        - name: books-sorted
          connection: bookdb
          mongoQuery:
            collection: books
            sort: '{"title": 1}'

    # Sort by year descending, then title ascending
    - name: books-sorted-multi
      queries:
        - name: books-by-year
          connection: bookdb
          mongoQuery:
            collection: books
            sort: '{"year": -1, "title": 1}'

    # Combined with filter and fields
    - name: books-fiction-sorted
      queries:
        - name: fiction-sorted
          connection: bookdb
          mongoQuery:
            collection: books
            filter: '{"genre":"Fiction"}'
            fields: '{"title": 1, "author": 1, "year": 1}'
            sort: '{"year": -1}'

    # Filtered fruit queries by colorW
    - name: fruits-color
      queries:
        - name: fruits-red
          connection: fruitdb
          queryString: SELECT name, color, taste FROM fruits WHERE color='Red'
        - name: fruits-yellow
          connection: fruitdb
          queryString: SELECT name, color, taste FROM fruits WHERE color='Yellow'
        - name: fruits-green
          connection: fruitdb
          queryString: SELECT name, color, taste FROM fruits WHERE color='Green'

    # Example of counting queries
    - name: statistics
      queries:
        - name: fruit-count
          connection: fruitdb
          queryString: SELECT COUNT(*) as total_fruits FROM fruits
        - name: animal-count
          connection: animaldb
          queryString: SELECT COUNT(*) as total_animals FROM animals
        - name: animals-by-diet
          connection: animaldb
          queryString: SELECT diet, COUNT(*) as count FROM animals GROUP BY diet ORDER BY count DESC

    # MongoDB Aggregation Pipeline Examples
    - name: books-aggregation
      queries:
        # Simple aggregation - group books by genre
        - name: books
          connection: bookdb
          mongoQuery:
            collection: books
            pipeline: |
              [
                {"$group": {"_id": "$genre", "count": {"$sum": 1}}},
                {"$sort": {"count": -1}}
              ]

        # Aggregation with filter - only books published after 1950
        - name: recent-books-by-genre
          connection: bookdb
          mongoQuery:
            collection: books
            filter: '{"year": {"$gte": 1950}}'
            pipeline: |
              [
                {"$group": {"_id": "$genre", "count": {"$sum": 1}, "avgYear": {"$avg": "$year"}}},
                {"$sort": {"count": -1}}
              ]

        # Combined: filter + pipeline + fields + sort
        - name: popular-genres
          connection: bookdb
          mongoQuery:
            collection: books
            filter: '{"year": {"$gte": 1900}}'
            pipeline: |
              [
                {"$group": {"_id": "$genre", "count": {"$sum": 1}, "avgYear": {"$avg": "$year"}}},
                {"$match": {"count": {"$gte": 2}}}
              ]
            fields: '{"_id": 1, "count": 1, "avgYear": 1}'
            sort: '{"count": -1}'

        # Group by author with book count
        - name: books-by-author
          connection: bookdb
          mongoQuery:
            collection: books
            pipeline: |
              [
                {"$group": {"_id": "$author", "bookCount": {"$sum": 1}, "genres": {"$addToSet": "$genre"}}},
                {"$sort": {"bookCount": -1}}
              ]
